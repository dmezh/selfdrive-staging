residents:
  - dbwNode_Steering
  - dbwNode_Brakes
  - techPc
  - dbwWatchdog

messages:
- dbwNode_Status:
    id: 0xA0
    cycletime: 100

    template: true
    template_ids:
      - Blink
      - Throttle

    senders:
      - dbwNode_Blink
      - dbwNode_Throttle

    signals:
      - SystemStatus:
          description: Simple yes/no health status of the node.
          width: 1
          choices:
            - HEALTHY
            - UNHEALTHY
      - Counter:
          description: Counter for fun.
          width: 8

- dbwNode_Info:
    id: 0x02
    cycletime: 100

    signals:
      - Githash:
           description: Githash of the currently-running firmware.
           width: 32
      - EepromIdentity:
           description: EEPROM identity.
           width: 6

- dbwNode_Accel_Data:
    id: 0x03
    cycletime: 100

    signals:
      - ThrottleACmd:
          description: Throttle A command.
          width: 8
      - ThrottleFCmd:
          description: Throttle B command.
          width: 8
      - Percent:
          description: Percentage commanded.
          width: 8
          unit: percent
      - RelayState:
          description: Current relay state.
          width: 1

- dbwNode_Accel_Cmd:
    id: 0x20
    cycletime: 100

    signals:
      - ThrottleCmd:
          description: Throttle command.
          minimum: 0.0
          maximum: 1.0
          scale: 0.01
          width: 8
      - ModeCtrl:
          description: Mode control command (0/1).
          width: 1

- dbwUpdater_Meta:
    id: 0xF0
    cycletime: 100

    signals:
      - Trigger:
          description: Trigger the update.
          width: 1
      - Begin:
          description: Begin the update.
          width: 1
      - FinalSize:
          description: Number of bytes in final image size.
          width: 32

- dbwUpdater_Data:
    id: 0xF1
    cycletime: 100

    signals:
      - Position:
          description: Index of 32-bit data chunk.
          width: 24
      - Data:
          description: Image data.
          width: 40

- dbwBootloader_Data:
    id: 0xF4
    cycletime: 100

    signals:
      - RunningPartitionType:
          description: Partition subtype (-1 if none).
          signed: yes
          width: 9
      - BootPartitionType:
          description: Partition subtype (-1 if none).
          signed: yes
          width: 9
      - UpdatePartitionType:
          description: Partition subtype (-1 if none).
          signed: yes
          width: 9
      - Ready:
          description: Ready to begin update.
          width: 1
      - OTAError:
          description: OTA error.
          width: 2
          choices:
            - OTA_NO_ERROR_YET
            - OTA_BEGIN_ERR
            - OTA_WRITE_ERR
            - OTA_END_ERR
            - OTA_SET_BOOT_PARTITION_ERR
      - EspErrCode:
          description: esp_err_t code from last error.
          width: 32

